!function(e){"use strict";function t(e){if(this.value=void 0,this.__deferreds__=[],arguments.length>0){var t=new n(this);if("function"==typeof e)try{e(function(e){t.fulfill(e)},function(e){t.reject(e)},function(e){t.notify(e)})}catch(r){t.reject(r)}else t.fulfill(e)}}function n(e){this.promise=e}function r(e){return e&&"object"==typeof e}function i(e){return e&&"function"==typeof e}function u(e){return 0===Object.keys(e).length}function o(e){if(1===e.length&&Array.isArray(e[0]))return e[0];for(var t=new Array(e.length),n=0;n<t.length;)t[n]=e[n++];return t}var f;"function"==typeof define&&define.amd?define(["subsequent"],function(e){return f=e,t}):"object"==typeof module&&module.exports?(module.exports=t,f=require("subsequent")):(e.Davy=t,f=e.subsequent),t.prototype.isFulfilled=!1,t.prototype.isRejected=!1,t.prototype.then=function(e,r,i){var u=t.defer(),o={resolver:u,fulfill:e,reject:r,notify:i};return this.isFulfilled||this.isRejected?n.handle([o],this.isFulfilled?n.SUCCESS:n.FAILURE,this.value):(this.value&&n.handle([o],n.NOTIFY,this.value),this.__deferreds__.push(o)),u.promise},n.SUCCESS="fulfill",n.FAILURE="reject",n.NOTIFY="notify",n.prototype.fulfill=function(e){var t=this.promise;if(!t.isFulfilled&&!t.isRejected){if(e===t)return void this.reject(new TypeError("Can't resolve a promise with itself."));if(r(e)||i(e)){var n;try{n=e.then}catch(u){return void this.reject(u)}if(i(n)){var o=!0,f=this;try{n.call(e,function(e){o&&(o=!1,f.fulfill(e))},function(e){o&&(o=!1,f.reject(e))},function(e){f.notify(e)})}catch(u){o&&this.reject(u)}return}}t.isFulfilled=!0,this.complete(e)}},n.prototype.reject=function(e){var t=this.promise;t.isFulfilled||t.isRejected||(t.isRejected=!0,this.complete(e))},n.prototype.notify=function(e){var t=this.promise;t.isFulfilled||t.isRejected||(t.value=e,n.handle(t.__deferreds__,n.NOTIFY,e))},n.prototype.complete=function(e){var t=this.promise,r=t.isFulfilled?n.SUCCESS:n.FAILURE;t.value=e,n.handle(t.__deferreds__,r,e),t.__deferreds__=void 0},n.handle=function(e,t,r){e.length&&f(function(){for(var u=0;u<e.length;){var o=e[u++],f=o[t],l=o.resolver;if(i(f)){var c;try{c=f(r)}catch(s){l.reject(s);continue}t===n.NOTIFY?l.notify(c):l.fulfill(c)}else l[t](r)}})},t.prototype.progress=function(e){return this.then(null,null,e)},t.prototype["catch"]=function(e){return this.then(null,e)},t.prototype["throw"]=function(){return this["catch"](function(e){f(function(){throw e})})},t.prototype["finally"]=function(e){return this.then(e,e)},t.prototype["yield"]=function(e){return this.then(function(){return e})},t.prototype.tap=function(e){return this.then(e)["yield"](this)},t.prototype.spread=function(e,t){return this.then(function(t){return e.apply(this,t)},t)},t.resolve=t.cast=function(e){return r(e)&&i(e.then)?e:new t(e)},t.reject=function(e){var n=t.defer();return n.reject(e),n.promise},t.defer=function(){return new n(new t)},t.each=function(e,n){var r=t.defer(),i=e.length;0===i&&r.fulfill(TypeError());for(var u=0;i>u;)n(e[u],u++,e);return r},t.all=function(){function e(e){c.reject(e)}function n(e,t,n){return function(r){e(r,t,n)}}function u(t,o,f){return r(t)&&i(t.then)?void t.then(n(u,o,f),e):(f[o]=t,void(0===--l&&c.fulfill(f)))}var f=o(arguments),l=f.length,c=t.each(f,u);return c.promise},t.race=function(){function e(e){f.reject(e)}function n(t){return r(t)&&i(t.then)?void t.then(n,e):void f.fulfill(t)}var u=o(arguments),f=t.each(u,n);return f.promise},t.wrap=function(e){return function(){for(var n=arguments.length,r=0,i=new Array(n+1),u=t.defer();n>r;)i[r]=arguments[r++];return i[n]=function(e,t){e?u.reject(e):u.fulfill(t)},e.apply(this,i),u.promise}},t.unwrap=function(e,n){function i(e,o){return t.resolve(e).then(function(e){if(!r(e)||u(e))return e;var f=Array.isArray(e),l=f?[]:{},c=Object.keys(e).map(function(r){if(n&&n[o]!==r)return t.resolve();var u=e[r];return f&&(r=l.length),l[r]=null,i(u,o+1).then(function(e){l[r]=e})});return t.all(c)["yield"](l)})}return i(e,0)}}(Function("return this")());
//# sourceMappingURL=davy.min.js.map